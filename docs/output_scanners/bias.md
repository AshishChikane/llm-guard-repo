# Bias Detection Scanner

This scanner is designed to inspect the outputs generated by Language Learning Models (LLMs) to detect and evaluate
potential biases. Its primary function is to ensure that LLM outputs remain neutral and don't exhibit unwanted or
predefined biases.

## Attack

In the age of AI, it's pivotal that machine-generated content adheres to neutrality. Biases, whether intentional or
inadvertent, in LLM outputs can be misrepresentative, misleading, or offensive. The `Bias` scanner serves to address
this by detecting and quantifying biases in generated content.

## How it works

The scanner utilizes a model from
HuggingFace: [valurank/distilroberta-bias](https://huggingface.co/valurank/distilroberta-bias). This model is
specifically trained to detect biased statements in text. By examining a text's classification and score against a
predefined threshold, the scanner determines whether it's biased.

!!! note

    Supported languages: English

## Usage

```python
from llm_guard.output_scanners import Bias

scanner = Bias(threshold=0.5)
sanitized_output, is_valid, risk_score = scanner.scan(prompt, model_output)
```

## Optimizations

### ONNX

The scanner can be optimized by using the ONNX converted model [laiyer/distilroberta-bias-onnx](https://huggingface.co/laiyer/distilroberta-bias-onnx).

To enable it, install the `onnxruntime` package:

```sh
pip install llm-guard[onnxruntime]
```

And set `use_onnx=True`.

## Benchmarks

Environment:

- Platform: Amazon Linux 2
- Python Version: 3.11.6

Run the following script:

```sh
python benchmarks/run.py output Bias
```

Results:

| Instance                     | Input Length | Test Times | Latency Variance | Latency 90 Percentile | Latency 95 Percentile | Latency 99 Percentile | Average Latency (ms) | QPS     |
|------------------------------|--------------|------------|------------------|-----------------------|-----------------------|-----------------------|----------------------|---------|
| AWS m5.xlarge                | 128          | 5          | 2.96             | 111.97                | 139.15                | 160.88                | 57.55                | 2224.21 |
| AWS m5.xlarge with ONNX      | 128          | 5          | 0.00             | 29.52                 | 29.79                 | 30.00                 | 28.82                | 4441.22 |
| AWS g5.xlarge GPU            | 128          | 5          | 32.51            | 275.34                | 365.39                | 437.44                | 94.85                | 1349.48 |
